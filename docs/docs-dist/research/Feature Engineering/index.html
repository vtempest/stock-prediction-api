<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-research/Feature Engineering" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.8.1"><title data-rh=true>Feature Engineering | BioGasEng API Routes Docs</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content="https://BioGasEng.com/research/Feature Engineering"><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="Feature Engineering | BioGasEng API Routes Docs"><meta data-rh=true name=description content="Features Used in Prophet Model"><meta data-rh=true property=og:description content="Features Used in Prophet Model"><link data-rh=true rel=icon href=https://biogaseng.com/wp-content/uploads/2019/05/fav-150x150.jpg><link data-rh=true rel=canonical href="https://BioGasEng.com/research/Feature Engineering"><link data-rh=true rel=alternate href="https://BioGasEng.com/research/Feature Engineering" hreflang=en><link data-rh=true rel=alternate href="https://BioGasEng.com/research/Feature Engineering" hreflang=x-default><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://BioGasEng.com/research/Feature Engineering","name":"Feature Engineering","position":1}]}</script><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=/////G-E5TZ32BZD"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","/////G-E5TZ32BZD",{})</script><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.11.0/css/all.css type=text/css><link rel=stylesheet href=/assets/css/styles.36dc19db.css><script src=/assets/js/runtime~main.bcff06d7.js defer></script><script src=/assets/js/main.b7eaa5d0.js defer></script><body class=navigation-with-keyboard><svg xmlns=http://www.w3.org/2000/svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light",e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=https://biogaseng.com/wp-content/uploads/2019/05/fav-150x150.jpg><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/functions><div class=navbar__logo><img src=https://biogaseng.com/wp-content/uploads/2019/05/fav-150x150.jpg alt=logo class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=https://biogaseng.com/wp-content/uploads/2019/05/fav-150x150.jpg alt=logo class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">BioGasEng Docs</b></a><a class="navbar__item navbar__link" href=/functions>ðŸ‘‹ Intro</a><a class="navbar__item navbar__link" href="/research/Model Comparison">ðŸ”¬ Research</a><a class="navbar__item navbar__link" href=/functions/modules>ðŸ”§ Server Functions</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><div class=navbar__search><span aria-label="expand searchbar" role=button class=search-icon tabindex=0></span><input id=search_input_react type=search placeholder=Loading... aria-label=Search class="navbar__search-input search-bar" disabled></div></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=true href=/functions/>Core Functions</a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/functions/>Energy Prediction System</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/functions/api-client/dist>api-client</a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/functions/call-predict>call-predict</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/functions/export-db-daily-total>export-db-daily-total</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/functions/export-db-status>export-db-status</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/functions/modules>modules</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href="/research/Feature Engineering">Research</a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href="/research/Feature Engineering">Feature Engineering</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href="/research/Model Comparison">Comparison of Prediction Models</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href="/research/Variables Biogas Output">Variables in Biogas Prediction (Case Studies)</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/research/Weighted_Ensemble_Improvements>Weighted Ensemble Improvements</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href="/research/XGBoost Params">XGBoost Params</a></ul></ul></nav><button type=button title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>Research</span><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>Feature Engineering</span></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Feature Engineering</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id=features-used-in-prophet-model>Features Used in Prophet Model<a href=#features-used-in-prophet-model class=hash-link aria-label="Direct link to Features Used in Prophet Model" title="Direct link to Features Used in Prophet Model">â€‹</a></h2>
<p><strong>Data Loading and Preparation</strong></p>
<ul>
<li>Loads multiple data sources: historical energy output, future weather forecasts, and official actuals.</li>
<li>Handles missing files and data validation, ensuring robust preprocessing.</li>
<li>Converts date columns to datetime and ensures numeric types for calculations.</li>
<li>Drops invalid or missing rows to maintain data integrity.</li>
</ul>
<p><strong>Feature Engineering</strong></p>
<p><em>Time-Based Features</em></p>
<ul>
<li>Extracts year, month, day, day of week, and day of year from timestamps.</li>
<li>Flags weekends.</li>
<li>(Commented out but present) Flags for month start/end and quarter.</li>
<li>(Commented out) Fourier-based cyclical features for month and day, capturing seasonality.</li>
</ul>
<p><em>Rolling and Statistical Features</em></p>
<ul>
<li>Calculates rolling statistics (mean, std, max, min, median) for energy output over multiple window sizes (3, 7, 15, 30 days).</li>
<li>Computes rolling skewness and kurtosis to capture distributional properties.</li>
<li>Computes rolling volatility (std/mean), range (max-min), and trend (difference over window).</li>
<li>Exponential moving averages (EMA) for different spans (7, 15, 30 days).</li>
<li>Rolling ratios between different window sizes for both mean and std.</li>
<li>Lag features for energy output (lags of 1, 2, 3, 7, 14, 21, 30 days).</li>
<li>Interaction features (e.g., rolling mean Ã— rolling std).</li>
</ul>
<p><em>Weather and Interaction Features</em></p>
<ul>
<li>Includes weather variables: temperature, soil moisture, humidity, precipitation.</li>
<li>(Commented out but present) Polynomial and interaction terms for temperature (squared, cubed), and interactions between temperature and other weather variables.</li>
<li>Interaction features between temperature and rolling means.</li>
</ul>
<p><em>Missing Value Handling</em></p>
<ul>
<li>Fills missing numeric values with median or forward/backward fill.</li>
<li>Replaces infinities with NaN and fills again to ensure no invalid values.</li>
</ul>
<p><strong>Modeling Approaches</strong></p>
<p><em>Prophet Model</em></p>
<ul>
<li>Uses Facebook Prophet with optimized parameters:<!-- -->
<ul>
<li>Increased seasonality complexity (higher Fourier orders for yearly, monthly, quarterly, biweekly).</li>
<li>Multiplicative seasonality mode.</li>
<li>More changepoints and wider changepoint range for flexibility.</li>
<li>Wider prediction intervals for uncertainty.</li>
<li>Custom seasonalities added for monthly, quarterly, and biweekly patterns.</li>
</ul>
</li>
<li>Adds multiple external regressors (weather and engineered features).</li>
<li>Fits the model to training data and predicts on test and future data.</li>
</ul>
<p><em>Ensemble Machine Learning Models</em></p>
<ul>
<li>Random Forest Regressor:<!-- -->
<ul>
<li>Tuned for more trees, deeper trees, and robust splitting criteria.</li>
<li>Uses all engineered features, including weather and rolling stats.</li>
<li>Trained on raw features.</li>
</ul>
</li>
<li>Ridge Regression:<!-- -->
<ul>
<li>Uses scaled features (RobustScaler for outlier resistance).</li>
<li>Regularization parameter tuned for reduced overfitting.</li>
</ul>
</li>
<li>Both models are trained and evaluated, and their predictions are compared.</li>
</ul>
<p><em>Train-Test Splitting</em></p>
<ul>
<li>Splits data chronologically to preserve time series order, avoiding data leakage.</li>
</ul>
<p><strong>Prediction and Evaluation</strong></p>
<p><em>Prediction Preparation</em></p>
<ul>
<li>Merges historical and future data to ensure continuity for rolling features.</li>
<li>Ensures all required regressors are present for Prophet, filling missing ones with zeros if needed.</li>
</ul>
<p><em>Evaluation Metrics</em></p>
<ul>
<li>Calculates MAE, RMSE, RÂ², MAPE, accuracy percentage, average percent error, and data range for both actual and predicted values.</li>
<li>Provides detailed printouts for model performance on both cross-validation and official prediction periods.</li>
</ul>
<p><em>Result Saving and Reporting</em></p>
<ul>
<li>Saves final predictions (with confidence intervals and weather data) to JSON.</li>
<li>Prints summary tables comparing model performance across all metrics.</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=summary-table-of-feature-types>Summary Table of Feature Types<a href=#summary-table-of-feature-types class=hash-link aria-label="Direct link to Summary Table of Feature Types" title="Direct link to Summary Table of Feature Types">â€‹</a></h2>
<table><thead><tr><th style=text-align:left>Feature Type<th style=text-align:left>Description<tbody><tr><td style=text-align:left>Time-based features<td style=text-align:left>Year, month, day, dayofweek, dayofyear, is_weekend, (quarter, is_month_start/end)<tr><td style=text-align:left>Rolling statistics<td style=text-align:left>Mean, std, max, min, median, skew, kurtosis (windows: 3, 7, 15, 30 days)<tr><td style=text-align:left>Volatility/trend features<td style=text-align:left>std/mean ratio, range, trend (difference over window)<tr><td style=text-align:left>Exponential moving averages<td style=text-align:left>EMA over 7, 15, 30 days<tr><td style=text-align:left>Lag features<td style=text-align:left>Energy output at prior 1, 2, 3, 7, 14, 21, 30 days<tr><td style=text-align:left>Interaction features<td style=text-align:left>Rolling mean Ã— std, temperature Ã— rolling mean, etc.<tr><td style=text-align:left>Weather features<td style=text-align:left>Temperature, soil moisture, humidity, precipitation<tr><td style=text-align:left>Polynomial/interactions (weather)<td style=text-align:left>Temperature squared/cubed, temp Ã— moisture, temp Ã— humidity, etc. (some commented out)<tr><td style=text-align:left>Model types<td style=text-align:left>Prophet (with regressors and custom seasonalities), Random Forest, Ridge Regression<tr><td style=text-align:left>Evaluation metrics<td style=text-align:left>MAE, RMSE, RÂ², MAPE, accuracy, average percent error, data range</table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=explanation>Explanation<a href=#explanation class=hash-link aria-label="Direct link to Explanation" title="Direct link to Explanation">â€‹</a></h2>
<p>This script integrates advanced time series feature engineering, robust data handling, and a hybrid modeling approach (statistical + machine learning) for improved energy forecasting. It leverages both domain-specific features (weather, time) and generic statistical properties (rolling stats, lags, interactions) to maximize predictive accuracy. The ensemble of Prophet and machine learning models allows for robust, interpretable, and flexible forecasting, validated with comprehensive metric reporting and result saving[^1].</div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/functions/modules><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>modules</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/research/Model Comparison"><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Comparison of Prediction Models</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#features-used-in-prophet-model class="table-of-contents__link toc-highlight">Features Used in Prophet Model</a><li><a href=#summary-table-of-feature-types class="table-of-contents__link toc-highlight">Summary Table of Feature Types</a><li><a href=#explanation class="table-of-contents__link toc-highlight">Explanation</a></ul></div></div></div></div></main></div></div></div></div>